(function(e){function t(t){for(var o,n,l=t[0],r=t[1],c=t[2],u=0,p=[];u<l.length;u++)n=l[u],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],o=!0,l=1;l<a.length;l++){var r=a[l];0!==i[r]&&(o=!1)}o&&(s.splice(t--,1),e=n(n.s=a[0]))}return e}var o={},i={app:0},s=[];function n(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=o,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=r;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var o=a("85ec"),i=a.n(o);i.a},"4c89":function(e,t,a){},"552d":function(e,t,a){"use strict";var o=a("b703"),i=a.n(o);i.a},"56d7":function(e,t,a){"use strict";a.r(t);a("b0c0"),a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},s=[],n=(a("034f"),a("2877")),l={},r=Object(n["a"])(l,i,s,!1,null,null,null),c=r.exports,d=a("8c4f"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"mainpage"}},[a("div",{staticClass:"title front"},[e._v("智能交通")]),a("div",{staticClass:"title rear"},[e._v("连接未来")]),a("div",{staticClass:"subtitle"},[e._v("基于计算机视觉的交通场景智能应用")]),a("div",{staticClass:"uploadcomponent"},[a("div",{staticClass:"uploadvideo",class:e.videoStyle},[a("ele-upload-video",{attrs:{fileSize:20,responseFn:e.handleResponse,action:"http://127.0.0.1:8000/upload/video",name:"video",value:e.video}}),e.VideoUploadSuccess?e._e():a("el-tag",{staticClass:"infotag",attrs:{type:"info",effect:"dark"}},[e._v("请上传待处理视频")]),e.VideoUploadSuccess?a("el-tag",{staticClass:"infotag",attrs:{type:"success",effect:"dark"}},[e._v("视频上传成功")]):e._e()],1),a("div",{staticClass:"uploadimage",class:e.imageStyle},[a("div",{attrs:{id:"ele-upload-img"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://127.0.0.1:8000/upload/image","show-file-list":!1,"on-success":e.handleUploadSuccess,"on-error":e.handleUploadError,name:"image"}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e.ImageUploadSuccess?e._e():a("el-tag",{staticClass:"infotag",attrs:{type:"info",effect:"dark"}},[e._v("请上传视频背景")]),e.ImageUploadSuccess?a("el-tag",{staticClass:"infotag",attrs:{type:"success",effect:"dark"}},[e._v("图片上传成功")]):e._e()],1)]),a("a",{staticClass:"chuli-button",attrs:{href:"javascript:viod(0)"},on:{click:e.chuliButtonHandler}},[e._v("开始处理")])])},p=[],h=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("bc3a")),f=a.n(h),v={name:"mainpage",data:function(){return{video:null,VideoUploadSuccess:!1,ImageUploadSuccess:!1,imageUrl:""}},computed:{videoStyle:function(){return{borderstyle:!this.VideoUploadSuccess,borderstylesuccess:this.VideoUploadSuccess}},imageStyle:function(){return{borderstyle:!this.ImageUploadSuccess,borderstylesuccess:this.ImageUploadSuccess}}},methods:{handleUploadError:function(e){this.$message({type:"error",message:"上传图片失败,请刷新页面重试"}),console.log("error",e)},handleResponse:function(e,t){this.video="/UploadFiles/upload_video.mp4",this.VideoUploadSuccess=!0},handleUploadSuccess:function(e,t,a){this.$message.success("图片上传成功!"),this.ImageUploadSuccess=!0,this.imageUrl=URL.createObjectURL(t.raw)},chuliButtonHandler:function(){if(this.VideoUploadSuccess&&this.ImageUploadSuccess){this.$loading({lock:!0,text:"正在处理中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.75)"});f.a.get("http://127.0.0.1:8000/api/process").then((function(e){"process finish"===e.data.message&&this.$router.push({path:"/result"})})).catch((function(e){console.log(e)}))}else this.$message({type:"error",message:"请先上传视频和图片！"}),this.$router.push({path:"/result"})}}},m=v,g=(a("59dd"),Object(n["a"])(m,u,p,!1,null,null,null)),y=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"root"},[a("div",{staticClass:"return"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-arrow-left"},on:{click:e.handleReturn}},[e._v("上一页")])],1),a("div",{staticClass:"pagetitle"},[e._v("视频处理结果")]),a("div",{staticClass:"videoplaywrapper"},[a("video",{attrs:{id:"videoplayer",autoplay:!1,src:e.videoUrl,height:"360",width:"640",controls:""}},[e._v("您的浏览器不支持Video标签。")])]),a("div",{staticClass:"tablewrapper"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",height:"360"}},[a("el-table-column",{attrs:{prop:"timeStamp",label:"视频时间戳",width:"120"}}),a("el-table-column",{attrs:{prop:"carID",label:"车辆ID",width:"90"}}),a("el-table-column",{attrs:{prop:"illegalInfo",label:"车辆违章情况"}})],1)],1),a("div",{staticClass:"downloadbutton"},[a("div",{staticClass:"downloadvideo"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleDownloadVideo}},[e._v("下载输出视频")])],1),a("div",{staticClass:"downloadtxt"},[a("el-button",{attrs:{type:"primary",round:""},on:{click:e.handleDownloadTxt}},[e._v("下载输出结果")])],1)])])},_=[],S={name:"result",data:function(){return{videoUrl:"",tableData:[]}},mounted:function(){var e=this;this.videoUrl="/OutputFiles/output_video.mp4",f.a.get("http://127.0.0.1:8000/api/videodata").then((function(t){e.tableData=JSON.parse(JSON.stringify(t.data.videodata))})).catch((function(e){console.log(e)}))},methods:{handleReturn:function(){this.$router.push({path:"/"})},handleDownloadVideo:function(){f.a.get("http://127.0.0.1:8000/api/downloadvideo").then().catch((function(e){console.log(e)}))},handleDownloadTxt:function(){f.a.get("http://127.0.0.1:8000/api/downloadtxt").then().catch((function(e){console.log(e)}))}}},w=S,U=(a("552d"),Object(n["a"])(w,b,_,!1,null,null,null)),C=U.exports;o["default"].use(d["a"]);var V=[{path:"/",name:"mainpage",component:y},{path:"/result",name:"result",component:C}],x=new d["a"]({mode:"history",routes:V}),O=x,$=a("5c96"),k=a.n($),P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ele-upload-video"},[e.value?e._e():a("el-upload",{attrs:{accept:e.accept,action:e.action,"before-upload":e.handleBeforeUploadVideo,data:e.data,disabled:e.videoUploadPercent>0&&e.videoUploadPercent<100,headers:e.headers,httpRequest:e.httpRequest,name:e.name,"on-error":e.handleUploadError,"on-progress":e.handleUploadProcess,"on-success":e.handleUploadSuccess,"show-file-list":!1,withCredentials:e.withCredentials,drag:""}},[e.videoUploadPercent>0?a("el-progress",{staticStyle:{"margin-top":"20px"},attrs:{percentage:e.videoUploadPercent,type:"circle"}}):[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v(" 将视频拖到此处，或 "),a("em",[e._v("点击上传")])]),e.showTip?a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"}):e._e()]],2),e.value?a("vue-hover-mask",{scopedSlots:e._u([{key:"action",fn:function(){return[a("span",{staticClass:"ele-upload-video_mask__item",on:{click:e.handlePlayerVideo}},[a("i",{staticClass:"el-icon-zoom-in"})]),a("span",{staticClass:"ele-upload-video_mask__item",on:{click:e.handleDeleteVideo}},[a("i",{staticClass:"el-icon-delete"})])]},proxy:!0}],null,!1,469529225)},[a("video",{style:{width:e.width+"px",height:e.height?e.height+"px":"auto"},attrs:{autoplay:!1,src:e.value}},[e._v("您的浏览器不支持视频播放")])]):e._e(),a("el-dialog",{attrs:{visible:e.isShowVideo,"append-to-body":""},on:{"update:visible":function(t){e.isShowVideo=t}}},[e.isShowVideo?a("video",{staticStyle:{width:"100%"},attrs:{autoplay:!0,src:e.value,controls:"controls"}},[e._v("您的浏览器不支持视频播放")]):e._e()])],1)},j=[],T=(a("caad"),a("a9e3"),a("b680"),a("ac1f"),a("2532"),a("1276"),a("9f5b")),D={name:"EleUploadVideo",components:{VueHoverMask:T["a"]},props:{value:{type:String},action:{type:String,required:!0},responseFn:Function,fileSize:{type:Number},width:{type:Number,default:360},height:{type:Number},isShowTip:{type:Boolean,default:!0},fileType:{type:Array},headers:Object,withCredentials:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},httpRequest:Function,accept:String},data:function(){return{isShowVideo:!1,videoUploadPercent:0}},computed:{showTip:function(){return this.isShowTip&&(this.fileType||this.fileSize)}},methods:{handleBeforeUploadVideo:function(e){var t=!1;if(Array.isArray(this.fileType)){var a=e.type.split("/");t="video"===a[0]&&this.fileType.includes(a[1])}else t=e.type.includes("video");if(!t)return this.$message.error("".concat(e.name,"格式不正确, 请上传格式正确的视频")),!1;if(this.fileSize){var o=e.size/1024/1024<this.fileSize;if(!o)return this.$message.error("上传视频大小不能超过".concat(this.fileSize,"MB哦!")),!1}return!0},handleUploadProcess:function(e,t){this.videoUploadPercent=Number(t.percentage.toFixed(0))},handleUploadSuccess:function(e,t){this.videoUploadPercent=0,this.$message.success("视频上传成功!"),this.responseFn?this.$emit("input",this.responseFn(e,t)):this.$emit("input",e)},handleUploadError:function(e,t,a){this.$message.error("视频上传失败, 请刷新页面重试!"),this.videoUploadPercent=0,this.$emit("error",e,t,a)},handleDeleteVideo:function(){this.$emit("delete"),this.$emit("input",null)},handlePlayerVideo:function(){this.isShowVideo=!0}}},I=D,E=(a("fd2b"),Object(n["a"])(I,P,j,!1,null,null,null)),F=E.exports;a("0fae");o["default"].config.productionTip=!1,o["default"].use(k.a),o["default"].component(F.name,F),new o["default"]({router:O,render:function(e){return e(c)}}).$mount("#app")},"59dd":function(e,t,a){"use strict";var o=a("4c89"),i=a.n(o);i.a},"85ec":function(e,t,a){},b2ee:function(e,t,a){},b703:function(e,t,a){},fd2b:function(e,t,a){"use strict";var o=a("b2ee"),i=a.n(o);i.a}});
//# sourceMappingURL=app.fc3e7493.js.map